syntax = "proto3";
package sso.user_role;
option go_package = "sso.user_role.v1;user_role";
import "google/protobuf/timestamp.proto";

service UserRoleService {
  rpc AssignRoleToUser (UserRoleRequest) returns (DeleteUserRoleResponse);
  rpc RevokeRoleFromUser (UserRoleRequest) returns (DeleteUserRoleResponse);
  rpc ListUserRoles (ListUserRolesRequest) returns (ListUserRolesResponse);
}

message UserRoleRequest {
  string user_id = 1;
  string role_id = 2;
  optional string expires_at = 3;
}

message ListUserRolesRequest {
  string user_id = 1;
  int32 page = 2;
  int32 page_size = 3;
  bool include_expired = 4; // Фильтр по истекшим ролям
}

message ListUserRolesResponse {
  message UserRole {
    string role_id = 1;
    string assigned_by = 2; // ID пользователя, назначившего роль
    string expires_at = 3;
  }
  repeated UserRole roles = 1;
}

message DeleteUserRoleResponse {
  bool success = 1;
  string message = 2;
}